<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>

<body>
    <script src="../../dist/wd.js"></script>
    <script>


        window.onload = function () {
            var state = wd.setMainConfig({
                isDebug: false
            });

            wd.load("../../data/", state).then(function (state) {
                console.log("complete", state);
                initSample(state);
            });


            function initSample(state) {
                var [state, box] = createBox(state);


                var [state, camera] = createCamera(state);



                // var state = wd.addLogicInitJob("initJob1", "", function(state){
                //     console.log("initJob1");
                //     return state
                // }, state);


                // var state = wd.addLogicUpdateJob("updateJob1", "", function(elapsed, state){
                //     console.log("updateJob1", elapsed);
                //     return state
                // }, state);


                // var state = wd.addRenderInitJob("initRenderJob1", "", function(gl, state){
                //     console.log("initRenderJob1", gl);
                //     return state
                // }, state);

                // var state = wd.addRenderInitJob("initRenderJob2", "preget_glslData", function(gl, state){
                //     console.log("initRenderJob2", gl);
                //     return state
                // }, state);


                // var state = wd.addRenderRenderJob("renderRenderJob1", "", function(gl, state){
                //     console.log("renderRenderJob1");
                //     return state
                // }, state);


                wd.startDirector(state);
            }

            function createBox(state) {
                var [state, material] = wd.createBasicMaterial(state);

                state = wd.setBasicMaterialColor(material, [0.0, 0.5, 0.2], state);

                var [state, meshRenderer] = wd.createMeshRenderer(state);

                var [state, obj] = wd.createGameObject(state);

                state = wd.addGameObjectBasicMaterialComponent(obj, material, state);
                state = wd.addGameObjectMeshRendererComponent(obj, meshRenderer, state);


                var [state, geometry] = wd.createBoxGeometry(state);

                state = wd.setBoxGeometryConfigData(geometry, {
                    width: 5,
                    height: 5,
                    depth: 5
                }, state);




                state = wd.addGameObjectGeometryComponent(obj, geometry, state);

                return [state, obj];

            }

            function createCamera(state) {

                var [state, cameraController] = wd.createCameraController(state);

                state = wd.setPerspectiveCameraNear(cameraController, 0.1, state);
                state = wd.setPerspectiveCameraFar(cameraController, 2000, state);
                state = wd.setPerspectiveCameraFovy(cameraController, 60, state);
                state = wd.setPerspectiveCameraAspect(cameraController, 1.0, state);


                state = wd.setCameraControllerPerspectiveCamera(cameraController, state);



                var [state, obj] = wd.createGameObject(state);

                state = wd.addGameObjectCameraControllerComponent(obj, cameraController, state);

                var transform = wd.unsafeGetGameObjectTransformComponent(obj, state);

                state = wd.setTransformLocalPosition(transform, [0, 0, 1500], state);

                return [state, obj];
            }
        }
    </script>
</body>

</html>