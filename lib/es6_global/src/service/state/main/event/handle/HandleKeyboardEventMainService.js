// Generated by BUCKLESCRIPT VERSION 3.1.4, PLEASE EDIT WITH CARE

import * as ArrayService$WonderCommonlib from "../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/ArrayService.js";
import * as HashMapService$WonderCommonlib from "../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/HashMapService.js";
import * as SparseMapService$WonderCommonlib from "../../../../../../../../node_modules/wonder-commonlib/lib/es6_global/src/SparseMapService.js";

function _getKeyCode(keyboardDomEvent) {
  return keyboardDomEvent.keyCode;
}

function _getShiftKey(keyboardDomEvent) {
  return keyboardDomEvent.shiftKey;
}

function _getKeyFromSpecialKeyMap(keyCode, $$char, specialKeyMap) {
  var match = SparseMapService$WonderCommonlib.get(keyCode, specialKeyMap);
  if (match) {
    return match[0];
  } else {
    return $$char;
  }
}

function _getKey(keyboardDomEvent, param) {
  var keyboardEventData = param[/* eventRecord */40][/* keyboardEventData */7];
  var specialKeyMap = keyboardEventData[/* specialKeyMap */0];
  var keyCode = keyboardDomEvent.keyCode;
  var $$char = String.fromCharCode(keyCode).toLowerCase();
  var match = keyboardDomEvent.shiftKey;
  if (match) {
    var match$1 = SparseMapService$WonderCommonlib.get(keyCode, keyboardEventData[/* shiftKeyByKeyCodeMap */1]);
    if (match$1) {
      return match$1[0];
    } else {
      var match$2 = HashMapService$WonderCommonlib.get($$char, keyboardEventData[/* shiftKeyByCharCodeMap */2]);
      if (match$2) {
        return match$2[0];
      } else {
        return _getKeyFromSpecialKeyMap(keyCode, $$char, specialKeyMap);
      }
    }
  } else {
    return _getKeyFromSpecialKeyMap(keyCode, $$char, specialKeyMap);
  }
}

function _convertKeyboardDomEventToKeyboardEvent(eventName, keyboardDomEvent, state) {
  return /* record */[
          /* name */eventName,
          /* keyCode */keyboardDomEvent.keyCode,
          /* ctrlKey */keyboardDomEvent.ctrlKey,
          /* altKey */keyboardDomEvent.altKey,
          /* shiftKey */keyboardDomEvent.shiftKey,
          /* metaKey */keyboardDomEvent.metaKey,
          /* key */_getKey(keyboardDomEvent, state),
          /* event */keyboardDomEvent
        ];
}

function execEventHandle(eventName, keyboardDomEvent, state) {
  var match = SparseMapService$WonderCommonlib.get(eventName, state[/* eventRecord */40][/* keyboardDomEventDataArrMap */2]);
  if (match) {
    return ArrayService$WonderCommonlib.reduceOneParam((function (state, param) {
                  return param[/* handleFunc */1](_convertKeyboardDomEventToKeyboardEvent(eventName, keyboardDomEvent, state), state);
                }), state, match[0]);
  } else {
    return state;
  }
}

export {
  _getKeyCode ,
  _getShiftKey ,
  _getKeyFromSpecialKeyMap ,
  _getKey ,
  _convertKeyboardDomEventToKeyboardEvent ,
  execEventHandle ,
  
}
/* ArrayService-WonderCommonlib Not a pure module */
