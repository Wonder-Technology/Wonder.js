// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

import * as Contract$Wonderjs                           from "../../definition/Contract.js";
import * as ArraySystem$Wonderjs                        from "../../structure/ArraySystem.js";
import * as GeometryGroupCommon$Wonderjs                from "../component/system/geometry/GeometryGroupCommon.js";
import * as MaterialGroupCommon$Wonderjs                from "../component/system/material/MaterialGroupCommon.js";
import * as GameObjectStateCommon$Wonderjs              from "./GameObjectStateCommon.js";
import * as SparseMapSystem$WonderCommonlib             from "../../../../../node_modules/wonder-commonlib/lib/es6_global/src/SparseMapSystem.js";
import * as GeometryGameObjectCommon$Wonderjs           from "../component/system/geometry/GeometryGameObjectCommon.js";
import * as MaterialGameObjectCommon$Wonderjs           from "../component/system/material/MaterialGameObjectCommon.js";
import * as GameObjectComponentCommon$Wonderjs          from "./GameObjectComponentCommon.js";
import * as GeometryAddComponentCommon$Wonderjs         from "../component/system/geometry/GeometryAddComponentCommon.js";
import * as MaterialAddComponentCommon$Wonderjs         from "../component/system/material/MaterialAddComponentCommon.js";
import * as TransformAddComponentCommon$Wonderjs        from "../component/system/transform/TransformAddComponentCommon.js";
import * as MeshRendererAddComponentCommon$Wonderjs     from "../component/system/meshRenderer/MeshRendererAddComponentCommon.js";
import * as ObjectInstanceAddComponentCommon$Wonderjs   from "../component/system/instance/objectInstance/ObjectInstanceAddComponentCommon.js";
import * as SourceInstanceAddComponentCommon$Wonderjs   from "../component/system/instance/sourceInstance/SourceInstanceAddComponentCommon.js";
import * as CameraControllerAddComponentCommon$Wonderjs from "../component/system/cameraController/CameraControllerAddComponentCommon.js";

function _addComponent(uid, component, componentMap) {
  Contract$Wonderjs.requireCheck((function () {
          return Contract$Wonderjs.test("this type of component is already exist, shouldn't add again", (function () {
                        return Contract$Wonderjs.assertFalse(GameObjectComponentCommon$Wonderjs.hasComponent(uid, componentMap));
                      }));
        }));
  SparseMapSystem$WonderCommonlib.set(uid, component, componentMap);
  return /* () */0;
}

function addSourceInstanceComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* sourceInstanceMap */9]);
  return SourceInstanceAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
}

function addObjectInstanceComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* objectInstanceMap */10]);
  return ObjectInstanceAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
}

function addCameraControllerComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* cameraControllerMap */5]);
  return CameraControllerAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
}

function addTransformComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* transformMap */4]);
  return TransformAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
}

function addGeometryComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* geometryMap */6]);
  var match = GeometryGameObjectCommon$Wonderjs.getGameObject(component, state);
  if (match) {
    return GeometryGroupCommon$Wonderjs.increaseGroupCount(component, state);
  } else {
    return GeometryAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
  }
}

function addMeshRendererComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* meshRendererMap */7]);
  return MeshRendererAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
}

function addMaterialComponent(uid, component, state) {
  _addComponent(uid, component, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* materialMap */8]);
  var match = MaterialGameObjectCommon$Wonderjs.getGameObject(component, state);
  if (match) {
    return MaterialGroupCommon$Wonderjs.increaseGroupCount(component, state);
  } else {
    return MaterialAddComponentCommon$Wonderjs.handleAddComponent(component, uid, state);
  }
}

function _batchAddComponent(uidArray, componentArr, componentMap, handleAddComponentFunc, state) {
  Contract$Wonderjs.requireCheck((function () {
          return Contract$Wonderjs.test("one gameObject should add one component", (function () {
                        return Contract$Wonderjs.Operators[/* = */0](uidArray.length, componentArr.length);
                      }));
        }));
  return ArraySystem$Wonderjs.reduceOneParami((function (state, uid, index) {
                var component = componentArr[index];
                _addComponent(uid, component, componentMap);
                return handleAddComponentFunc(component, uid, state);
              }), state, uidArray);
}

function _batchAddSharableComponent(uidArray, componentArr, componentMap, increaseGroupCountFunc, state) {
  Contract$Wonderjs.requireCheck((function () {
          return Contract$Wonderjs.test("one gameObject should add one component", (function () {
                        return Contract$Wonderjs.Operators[/* = */0](uidArray.length, componentArr.length);
                      }));
        }));
  return ArraySystem$Wonderjs.reduceOneParami((function (state, uid, index) {
                var component = componentArr[index];
                _addComponent(uid, component, componentMap);
                return increaseGroupCountFunc(component, state);
              }), state, uidArray);
}

function batchAddTransformComponentForClone(uidArray, componentArr, state) {
  return _batchAddComponent(uidArray, componentArr, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* transformMap */4], TransformAddComponentCommon$Wonderjs.handleAddComponent, state);
}

function batchAddMeshRendererComponentForClone(uidArray, componentArr, state) {
  return _batchAddComponent(uidArray, componentArr, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* meshRendererMap */7], MeshRendererAddComponentCommon$Wonderjs.handleAddComponent, state);
}

function batchAddGeometryComponentForClone(uidArray, componentArr, state) {
  return _batchAddSharableComponent(uidArray, componentArr, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* geometryMap */6], GeometryGroupCommon$Wonderjs.increaseGroupCount, state);
}

function batchAddMaterialComponentForClone(uidArray, componentArr, isShareMaterial, state) {
  var componentMap = GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* materialMap */8];
  if (isShareMaterial !== 0) {
    return _batchAddSharableComponent(uidArray, componentArr, componentMap, MaterialGroupCommon$Wonderjs.increaseGroupCount, state);
  } else {
    return _batchAddComponent(uidArray, componentArr, componentMap, MaterialAddComponentCommon$Wonderjs.handleAddComponent, state);
  }
}

function batchAddCameraControllerComponentForClone(uidArray, componentArr, state) {
  return _batchAddComponent(uidArray, componentArr, GameObjectStateCommon$Wonderjs.getGameObjectData(state)[/* cameraControllerMap */5], CameraControllerAddComponentCommon$Wonderjs.handleAddComponent, state);
}

export {
  _addComponent                             ,
  addSourceInstanceComponent                ,
  addObjectInstanceComponent                ,
  addCameraControllerComponent              ,
  addTransformComponent                     ,
  addGeometryComponent                      ,
  addMeshRendererComponent                  ,
  addMaterialComponent                      ,
  _batchAddComponent                        ,
  _batchAddSharableComponent                ,
  batchAddTransformComponentForClone        ,
  batchAddMeshRendererComponentForClone     ,
  batchAddGeometryComponentForClone         ,
  batchAddMaterialComponentForClone         ,
  batchAddCameraControllerComponentForClone ,
  
}
/* ArraySystem-Wonderjs Not a pure module */
